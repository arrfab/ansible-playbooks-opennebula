---
- hosts: localhost:thingreen:attic
  user: root
  tasks:
    - name: Checking CentOS distro-release
      action: command /bin/rpm -q --queryformat '%{version}\n' centos-release
      register: centos_release
    - name: Configuring YUM repositories
      action: template src=../templates/yum-repositories/$item.j2 dest=/etc/yum.repos.d/$item
      with_items:
        - rpmforge.repo
        - epel.repo
        - elrepo.repo
        - atrpms.repo
    - name: Configuring rpm-gpg keys for repositories    
      action: copy src=../files/rpm-gpg/$item dest=/etc/pki/rpm-gpg/$item
      with_items:
        - RPM-GPG-KEY-elrepo.org
        - RPM-GPG-KEY-EPEL-${centos_release.stdout}
        - RPM-GPG-KEY-rpmforge-dag
    - name: Disabling yum-presto (if installed)
      action: yum name=yum-presto state=absent
